generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlserver"
  url      = env("DATABASE_URL")
}

//
// Tabela SF1010 - Cabeçalho da Pré-nota
//
model SF1010 {
  R_E_C_N_O_ Int    @id @default(autoincrement()) // REC
  F1_FILIAL  String
  F1_DOC     String
  F1_SERIE   String
  F1_FORNECE String
  F1_LOJA    String

  // Campos de controle
  F1_STATUS  String?
  F1_EMISSAO String?
  F1_DTDIGIT String?
  F1_RECBMTO String?
  F1_USERLGI String?
  D_E_L_E_T_ String? @default("")

  // Campos auxiliares
  F1_XTIPO   String?
  F1_XPRIOR  String?
  F1_XORI    String?
  F1_XUSRRA  String?
  F1_XOBS    String?
  F1_XREV    String?
  F1_ZOBSREV String?

  // Relacionamentos
  SD1 SD1010[] // Itens vinculados
  SA2 SA2010?  @relation(fields: [F1_FORNECE, F1_LOJA], references: [A2_COD, A2_LOJA])

  @@unique([F1_FILIAL, F1_DOC, F1_SERIE, F1_FORNECE, F1_LOJA])
}

//
// Tabela SD1010 - Itens da Nota
//
model SD1010 {
  R_E_C_N_O_ Int    @id @default(autoincrement()) // REC
  D1_FILIAL  String
  D1_DOC     String
  D1_SERIE   String
  D1_FORNECE String
  D1_LOJA    String

  D1_TOTAL   Float
  D1_TES     String?
  D_E_L_E_T_ String? @default("")

  SF1 SF1010? @relation(fields: [D1_FILIAL, D1_DOC, D1_SERIE, D1_FORNECE, D1_LOJA], references: [F1_FILIAL, F1_DOC, F1_SERIE, F1_FORNECE, F1_LOJA])
  SF4 SF4010? @relation(fields: [D1_TES], references: [F4_CODIGO])
}

//
// Tabela SF4010 - TES (Tipo de Entrada/Saída)
//
model SF4010 {
  F4_CODIGO  String  @id
  F4_TRANFIL String?
  D_E_L_E_T_ String? @default("")

  SD1 SD1010[]
}

//
// Tabela SA2010 - Fornecedores
//
model SA2010 {
  A2_COD  String
  A2_LOJA String

  A2_NOME    String
  A2_CGC     String?
  D_E_L_E_T_ String? @default("")

  SF1 SF1010[]

  @@id([A2_COD, A2_LOJA])
}

//
// Tabela SB1010 - Cadastro de Produtos
//
model SB1010 {
  R_E_C_N_O_ Int    @id @default(autoincrement()) // REC
  B1_FILIAL  String // Filial do Produto
  B1_COD     String // Código do Produto
  B1_DESC    String // Descrição do Produto

  // Campos básicos para listagem e informação
  B1_TIPO   String? // Tipo do Produto (ex: PA, MP, ME, SV)
  B1_UM     String? // Unidade de Medida Principal
  B1_GRUPO  String? // Grupo de Produtos
  B1_PRV1   Float? // Preço de Venda 1
  B1_LOCPAD String? // Armazém Padrão do Produto
  B1_MARCA  String? // Marca do Produto

  // Campos de controle
  B1_MSBLQL  String? // Produto Bloqueado? ('1'-Sim / '2'-Não)
  D_E_L_E_T_ String? @default("") // Flag de Deleção

  // Relacionamentos
  ItensPedidoCompra SC7010[] // Itens de Pedido de Compra que utilizam este produto

  @@unique([B1_FILIAL, B1_COD]) // Chave única para Filial + Código do Produto
  @@index([B1_GRUPO]) // Índice para otimizar buscas por Grupo
  @@index([B1_TIPO]) // Índice para otimizar buscas por Tipo
  @@index([B1_DESC]) // Índice para otimizar buscas por Descrição
}

//
// Tabela SC7010 - Pedidos de Compra
//
model SC7010 {
  R_E_C_N_O_ Int     @id @default(autoincrement()) // REC
  C7_FILIAL  String
  C7_NUM     String
  C7_ITEM    String
  C7_PRODUTO String
  C7_EMISSAO String?
  C7_OBS     String?
  C7_USER    String?

  D_E_L_E_T_ String? @default("")

  // Relacionamento com Produtos (SB1)
  // Assume que C7_FILIAL e C7_PRODUTO formam a chave estrangeira para SB1010
  Produto SB1010? @relation(fields: [C7_FILIAL, C7_PRODUTO], references: [B1_FILIAL, B1_COD], map: "FK_SC7010_SB1010")

  @@unique([C7_FILIAL, C7_NUM, C7_ITEM, C7_PRODUTO])
  @@index([C7_FILIAL, C7_PRODUTO]) // Índice para a chave estrangeira do produto
}

//
// Tabela SE2010 - Títulos a Pagar
//
model SE2010 {
  R_E_C_N_O_ Int    @id @default(autoincrement()) // REC
  E2_FILIAL  String
  E2_NUM     String
  E2_PREFIXO String
  E2_FORNECE String
  E2_LOJA    String

  E2_PARCELA String?
  E2_VENCTO  String?
  E2_BAIXA   String?
  E2_VALOR   Float?
  E2_HIST    String?

  D_E_L_E_T_ String? @default("")

  @@unique([E2_FILIAL, E2_NUM, E2_PREFIXO, E2_FORNECE, E2_LOJA, E2_PARCELA])
}

//
// Tabela Z05010 - Histórico de alterações (logs)
//
model Z05010 {
  R_E_C_N_O_ Int    @id @default(autoincrement()) // REC
  Z05_FILIAL String
  Z05_CHAVE  String

  Z05_ROTINA String?
  Z05_CAMPO  String?
  Z05_VALATU String?
  Z05_DATA   String?
  Z05_HORA   String?
  Z05_USER   String?

  D_E_L_E_T_ String? @default("")
}

//
// Tabela SYS_USR - Usuários do sistema
//
model SYS_USR {
  R_E_C_N_O_ Int     @id @default(autoincrement()) // REC
  USR_ID     String
  USR_NOME   String
  USR_CODIGO String
  D_E_L_E_T_ String? @default("")
}

//
// Tabela Z10010 - Títulos (resumo)
//
model Z10010 {
  R_E_C_N_O_ Int     @id @default(autoincrement()) // REC
  Z10_TIPO   String
  Z10_CHAVE  String
  Z10_VENCTO String?
  D_E_L_E_T_ String? @default("")
}

//
// Tabela Z07010 - Observações
//
model Z07010 {
  R_E_C_N_O_ Int     @id @default(autoincrement()) // REC
  Z07_CHAVE  String
  Z07_DESC   String?
  D_E_L_E_T_ String? @default("")
}
